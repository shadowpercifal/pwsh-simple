$PT='your text here'; $KEY='your passphrase'; $salt=New-Object byte[] 16; $iv=New-Object byte[] 16; (New-Object Security.Cryptography.RNGCryptoServiceProvider).GetBytes($salt); (New-Object Security.Cryptography.RNGCryptoServiceProvider).GetBytes($iv); $kdf=New-Object Security.Cryptography.Rfc2898DeriveBytes($KEY,$salt,100000); $aes=[Security.Cryptography.Aes]::Create(); $aes.Key=$kdf.GetBytes(32); $aes.IV=$iv; $bytes=[Text.Encoding]::UTF8.GetBytes($PT); $ct=$aes.CreateEncryptor().TransformFinalBlock($bytes,0,$bytes.Length); [Convert]::ToBase64String([byte[]]($salt+$iv+$ct))
